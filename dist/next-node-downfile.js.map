{"version":3,"sources":["next-node-downfile.js"],"names":[],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"next-node-downfile.js","sourcesContent":["(function() {\n  var global = global || this || window || Function('return this')();\n  var nx = global.nx || require('@feizheng/next-js-core2');\n  var fetch = require('node-fetch');\n  var fs = require('fs');\n  var DEFAULT_OPTIONS = {};\n\n  nx.nodeDownfile = function(inOptions) {\n    var options = nx.mix(null, DEFAULT_OPTIONS, inOptions);\n    var filename = options.filename;\n    var url = options.url;\n    return new Promise(function(resolve, reject) {\n      return fetch(url, options).then(function(res) {\n        var fileStream = fs.createWriteStream(filename);\n        res.body.pipe(fileStream);\n        res.body.on('error', function(err) {\n          fileStream.close();\n          reject({ code: 1 });\n        });\n        fileStream.on('finish', function() {\n          fileStream.close();\n          resolve({ code: 0 });\n        });\n      });\n    });\n  };\n\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = nx.nodeDownfile;\n  }\n})();\n"]}